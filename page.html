<!doctype html>
<html>
    <head>
        <title> Interactive Language Notes </title>

        <link rel="stylesheet/less" type="text/css" href="/layout.less" />
        <link rel="stylesheet/less" type="text/css" href="/styles.less" />
        <script type="text/javascript" src="/less.js"></script>

        <script type="text/javascript" src="/require.js"></script>
    </head>
    <body>

        <div id="app-container"> <!-- bound to app -->
            <div class="top_bar">
                <button data-bind="click: loadLessonList">Lesson List</button>
                <button data-bind="click: newLesson">New Lesson</button>
            </div>
            <!-- ko if: loading -->
                Loading .....
            <!-- /ko -->
            <!-- ko with: item -->
                <!-- ko template: template_name -->
                <!-- /ko -->
            <!-- /ko -->
            <!-- ko if: error -->
                <code data-bind="text: error | json:4"></code>
            <!-- /ko -->
        </div>

        <script type="text/html" id="lesson_template">
            <div class="lesson">
                <div class="lesson_side">
                    <div class="player">
                        <h1 data-bind="text: title"></h1>

                        <video controls="controls" data-bind="attr.src: video_source, element: video_element"> </video>

                        <p>
                            <code> Video Position: {{ video_time | as_timestamp }} </code>
                        </p>
                        <div class="controls">
                            <button data-bind="click: video_back_peek, enable: video_paused">Back-Peek</button>
                            <button data-bind="click: video_peek, enable: video_paused">Peek</button>
                            <button data-bind="click: backward_smaller, enable: video_paused"> < </button>
                            <button data-bind="click: backward_small, enable: video_paused"> <= </button>
                            <button data-bind="click: forward_small, enable: video_paused"> => </button>
                            <button data-bind="click: forward_smaller, enable: video_paused"> > </button>
                            <button data-bind="click: use_prev_section, enable: prev_section"> &lt; Prev Segment</button>
                            <button data-bind="click: use_next_section, enable: next_section">Next Segment &gt; </button>
                            <button data-bind="click: insert_section_at_player_time, enable: video_paused"> + New Segment </button>
                            <button data-bind="click: save, enable: save_enabled, text: save_text"></button>
                        </div>
                    </div>

                    <div class="sections">
                        <!-- ko foreach: sections -->
                        <div class="section" data-bind="click: click, css.current: $parent.current_section() == $data">
                            <p>
                                <code> {{ time | as_timestamp }}: </code>
                                <span data-bind="html: text.as_html"></span>
                            </p>
                        </div>
                        <!-- /ko -->
                        <div class="json">
                            <textarea style="width: 100%; height: 400px" data-bind="value: as_json"></textarea>
                        </div>
                    </div>
                </div>

                <div class="notes_side">
                    <div class="current_notes" data-bind="with: current_section">
                        <div class="controls">
                            <button data-bind="click: $parent.note_edit_mode.turn_on, enable: lesson.video_paused, visible: $parent.note_edit_mode.is_off">Edit</button>
                            <button data-bind="click: $parent.note_edit_mode.turn_off, enable: lesson.video_paused, visible: $parent.note_edit_mode.is_on">View</button>
                            <button data-bind="click: use_video_time, enable: lesson.video_paused">Start From Video Time</button>
                            <button data-bind="click: jump_video_to_start"> |&lt; </button>
                            <button data-bind="click: play_section_only, enable: lesson.video_paused"> [&gt;] </button>
                        </div>
                        <div class="text" data-bind="visible: $parent.note_edit_mode.is_off">
                            <span data-bind="html: text.as_html"></span>
                        </div>
                        <div class="text_editor">
                            <textarea data-bind="value: text, valueUpdate: 'input', visible: $parent.note_edit_mode.is_on"></textarea>
                        </div>
                        <div class="notes" data-bind="foreach: notes">
                            <div class="note">
                                <span data-bind="html: text.as_html"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </script>
        <script type="text/html" id="new_lesson_template">
            <input data-bind="value: media, valueUpdate:'input'" placeholder="remember.webm" />
            <input data-bind="value: title, valueUpdate:'input'" placeholder="H&MC Remember" />
            <input data-bind="value: text_language, valueUpdate:'input'" placeholder="japanese" />
            <input data-bind="value: user_language, valueUpdate:'input'" placeholder="arabic" />
            <button data-bind="click: start">Go!</button>
        </script>

        <script type="text/html" id="lesson_list_template">
            <div data-bind="foreach: lessons">
                <div>
                    <a href="" data-bind="click: load, text: title"></a>
                </div>
            </div>
        </script>

        <script type="text/javascript">
            require(['rconfig'], function() {
                require(['main']);
            });
        </script>
    </body>
</html>
